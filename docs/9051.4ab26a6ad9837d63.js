"use strict";var L=Object.defineProperty,T=Object.defineProperties,g=Object.getOwnPropertyDescriptors,E=Object.getOwnPropertySymbols,U=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable,h=(n,s,t)=>s in n?L(n,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[s]=t,v=(n,s)=>{for(var t in s||(s={}))U.call(s,t)&&h(n,t,s[t]);if(E)for(var t of E(s))j.call(s,t)&&h(n,t,s[t]);return n},O=(n,s)=>T(n,g(s));(self.webpackChunkdemo2=self.webpackChunkdemo2||[]).push([[9051],{39051:(n,s,t)=>{t.r(s),t.d(s,{default:()=>M});var m=t(15861),_=t(17626),u=t(26584),l=t(62208),p=t(32917),d=t(77712),D=(t(85931),t(8314),t(90912),t(76898)),P=t(17253),f=t(1607),I=t(43930);function y(e,r){if((0,l.Wi)(e)&&(0,l.Wi)(r))return null;const a={};return(0,l.pC)(r)&&(a.geometry=r.toJSON()),(0,l.pC)(e)&&(a.where=e),a}let i=class extends f.default{constructor(){super(...arguments),this._enabledDataReceived=!1,this.errorString=null,this.connectionStatus="disconnected"}initialize(){this.handles.add([(0,p.YP)(()=>{var e;return null==(e=this.layer)?void 0:e.purgeOptions},()=>this._update()),(0,p.YP)(()=>this.suspended,e=>{e?this._proxy.pauseStream():this._proxy.resumeStream()})])}get connectionError(){if(this.errorString)return new u.Z("stream-controller",this.errorString)}on(e,r){"data-received"===e&&(this._enabledDataReceived=!0,this._proxy.enableEvent("data-received",!0));const a=super.on(e,r),o=this;return{remove(){a.remove(),"data-received"===e&&(o._proxy.closed||o.hasEventListener("data-received")||o._proxy.enableEvent("data-received",!1))}}}queryLatestObservations(e,r){if(!this.layer.timeInfo.endField&&!this.layer.timeInfo.startField)throw new u.Z("streamlayer-no-timeField","queryLatestObservation can only be used with services that define a TrackIdField");return this._proxy.queryLatestObservations(this._cleanUpQuery(e),r).then(a=>{const o=P.default.fromJSON(a);return o.features.forEach(c=>{c.layer=this.layer,c.sourceLayer=this.layer}),o})}detach(){super.detach(),this.connectionStatus="disconnected"}_createClientOptions(){return O(v({},super._createClientOptions()),{setProperty:e=>{this.set(e.propertyName,e.value)}})}_createTileRendererHash(e){const r=`${JSON.stringify(this.layer.purgeOptions)}.${JSON.stringify(y(this.layer.definitionExpression,this.layer.geometryDefinition))})`;return super._createTileRendererHash(e)+r}_createServiceOptions(){var e=this;return(0,m.Z)(function*(){const r=e.layer,{objectIdField:a}=r,o=r.fields.map(C=>C.toJSON()),c=(0,I.oq)(r.geometryType),R=r.timeInfo&&r.timeInfo.toJSON()||null,S=r.spatialReference?r.spatialReference.toJSON():null;return{type:"stream",fields:o,geometryType:c,objectIdField:a,timeInfo:R,source:e.layer.parsedUrl,serviceFilter:y(e.layer.definitionExpression,e.layer.geometryDefinition),purgeOptions:e.layer.purgeOptions.toJSON(),enableDataReceived:e._enabledDataReceived,spatialReference:S,maxReconnectionAttempts:e.layer.maxReconnectionAttempts,maxReconnectionInterval:e.layer.maxReconnectionInterval,updateInterval:e.layer.updateInterval,customParameters:r.customParameters}})()}};(0,_._)([(0,d.Cb)()],i.prototype,"errorString",void 0),(0,_._)([(0,d.Cb)({readOnly:!0})],i.prototype,"connectionError",null),(0,_._)([(0,d.Cb)()],i.prototype,"connectionStatus",void 0),i=(0,_._)([(0,D.j)("esri.views.2d.layers.StreamLayerView2D")],i);const M=i}}]);
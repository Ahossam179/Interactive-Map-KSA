"use strict";(self.webpackChunkdemo2=self.webpackChunkdemo2||[]).push([["node_modules_arcgis_core_layers_save_featureLayerUtils_js-node_modules_arcgis_core_layers_sup-f0efb2","node_modules_arcgis_core_layers_support_lazyLayerLoader_js"],{36912:(W,g,e)=>{e.r(g),e.d(g,{save:()=>ie,saveAll:()=>ye,saveAs:()=>fe});var a=e(15861),p=e(85931),r=e(26584),u=e(63290),y=e(62208),h=e(10699),P=e(52489),Q=e(32258),X=e(24578),_=e(38305),B=e(72469),b=e(84687),w=e(55463),j=e(88755),m=e(37281);const k=u.Z.getLogger("esri.layers.FeatureLayer"),v="Feature Service";function L(t,n){return`Layer (title: ${t.title}, id: ${t.id}) of type '${t.declaredClass}' ${n}`}function F(t,n){if(n.type!==v)throw new r.Z("feature-layer:portal-item-wrong-type",L(t,`should have portal item of type "${v}"`))}function G(t){return S.apply(this,arguments)}function S(){return(S=(0,a.Z)(function*(t){if(yield t.load(),(0,B.rQ)(t))throw new r.Z("feature-layer:save",L(t,"using an in-memory source cannot be saved to a portal item"))})).apply(this,arguments)}function q(t,n){let s=t.messages.filter(({type:o})=>"error"===o).map(({name:o,message:i,details:l})=>new r.Z(o,i,l));if(null!=n&&n.ignoreUnsupported&&(s=s.filter(({name:o})=>"layer:unsupported"!==o&&"symbol:unsupported"!==o&&"symbol-layer:unsupported"!==o&&"property:unsupported"!==o&&"url:unsupported"!==o)),s.length>0)throw new r.Z("feature-layer:save","Failed to save feature layer due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:s})}function E(t,n,s){return M.apply(this,arguments)}function M(){return(M=(0,a.Z)(function*(t,n,s){"beforeSave"in t&&"function"==typeof t.beforeSave&&(yield t.beforeSave());const o=t.write({},n);return q(n,s),o})).apply(this,arguments)}function N(t){const{layer:n,layerJSON:s}=t;return n.isTable?{layers:[],tables:[s]}:{layers:[s],tables:[]}}function I(t){(0,m.qj)(t,m.Kz.JSAPI),t.typeKeywords&&(t.typeKeywords=t.typeKeywords.filter((n,s,o)=>o.indexOf(n)===s))}function ee(t){const n=t.portalItem;if(!n)throw k.error("save: requires the portalItem property to be set"),new r.Z("feature-layer:portal-item-not-set",L(t,"requires the portalItem property to be set"));if(!n.loaded)throw new r.Z("feature-layer:portal-item-not-loaded",L(t,"cannot be saved to a portal item that does not exist or is inaccessible"));F(t,n)}function J(t,n){return O.apply(this,arguments)}function O(){return(O=(0,a.Z)(function*(t,n){return/\/\d+\/?$/.test(t.url)?N(n[0]):te(t,n)})).apply(this,arguments)}function te(t,n){return D.apply(this,arguments)}function D(){return(D=(0,a.Z)(function*(t,n){const{layer:{url:s,customParameters:o,apiKey:i}}=n[0];let l=yield t.fetchData("json");l&&null!=l.layers&&null!=l.tables||(l=yield ne(l,{url:s,customParameters:o,apiKey:i},n.map(d=>d.layer.layerId)));for(const d of n)$(d.layer,d.layerJSON,l);return l})).apply(this,arguments)}function ne(t,n,s){return Z.apply(this,arguments)}function Z(){return(Z=(0,a.Z)(function*(t,n,s){var o,i;t||(t={}),(o=t).layers||(o.layers=[]),(i=t).tables||(i.tables=[]);const{url:l,customParameters:d,apiKey:f}=n,{serviceJSON:c,layersJSON:A}=yield(0,X.fetchFeatureService)(l,{customParameters:d,apiKey:f}),Y=z(t.layers,c.layers,s),H=z(t.tables,c.tables,s);t.layers=Y.itemResources,t.tables=H.itemResources;const ce=[...Y.added,...H.added],ge=A?[...A.layers,...A.tables]:[];return yield re(t,ce,l,ge),t})).apply(this,arguments)}function z(t,n,s){const o=(0,p.e5)(t,n,(l,d)=>l.id===d.id);t=t.filter(l=>!o.removed.some(d=>d.id===l.id));const i=o.added.map(({id:l})=>({id:l}));return i.forEach(({id:l})=>{t.push({id:l})}),{itemResources:t,added:i.filter(({id:l})=>!s.includes(l))}}function re(t,n,s,o){return T.apply(this,arguments)}function T(){return(T=(0,a.Z)(function*(t,n,s,o){const i=n.map(({id:l})=>new Q.default({url:s,layerId:l,sourceJSON:o.find(({id:d})=>d===l)}));yield(0,h.as)(i.map(l=>l.load())),i.forEach(l=>{const{layerId:d,loaded:f,defaultPopupTemplate:c}=l;!f||(0,y.Wi)(c)||$(l,{id:d,popupInfo:c.toJSON()},t)})})).apply(this,arguments)}function $(t,n,s){!function V(t,n){const s=t.findIndex(({id:o})=>o===n.id);-1===s?t.push(n):t[s]=n}(t.isTable?s.tables:s.layers,n)}function oe(t){const{portalItem:n}=t;return(0,B.y2)(t)&&!t.dynamicDataSource&&!(null==n||!n.loaded)&&n.type===v}function x(){return(x=(0,a.Z)(function*(t){if(null==t||!t.length)throw new r.Z("feature-layer-utils-saveall:missing-parameters","'layers' array should contain at least one feature layer");yield Promise.all(t.map(o=>o.load()));for(const o of t)if(!oe(o))throw new r.Z("feature-layer-utils-saveall:invalid-parameters",`'layers' array should only contain layers or tables in a feature service loaded from 'Feature Service' item. ${L(o,"does not conform")}`,{layer:o});const n=t.map(o=>o.portalItem.id);if(new Set(n).size>1)throw new r.Z("feature-layer-utils-saveall:invalid-parameters","All layers in the 'layers' array should be loaded from the same portal item");const s=t.map(o=>o.layerId);if(new Set(s).size!==s.length)throw new r.Z("feature-layer-utils-saveall:invalid-parameters","'layers' array should contain only one instance each of layer or table in a feature service")})).apply(this,arguments)}function ae(t,n){var s,o;let i=w.default.from(n);return i.id&&(i=i.clone(),i.id=null),null!=(s=i).type||(s.type=v),null!=(o=i).portal||(o.portal=b.Z.getDefault()),F(t,i),i}function le(t,n){return U.apply(this,arguments)}function U(){return(U=(0,a.Z)(function*(t,n){const{url:s,layerId:o,title:i,fullExtent:l,isTable:d}=t,f=(0,_.Qc)(s),c=(0,y.pC)(f)&&"FeatureServer"===f.serverType;n.url=c?s:`${s}/${o}`,n.title||(n.title=i),n.extent=null,!d&&(0,y.pC)(l)&&(n.extent=yield(0,m.$o)(l)),(0,m.ck)(n,m.Kz.METADATA),(0,m.ck)(n,m.Kz.MULTI_LAYER),(0,m.qj)(n,m.Kz.SINGLE_LAYER),d&&(0,m.qj)(n,m.Kz.TABLE),I(n)})).apply(this,arguments)}function ue(t,n,s){return C.apply(this,arguments)}function C(){return(C=(0,a.Z)(function*(t,n,s){const o=t.portal;yield o._signIn(),yield o.user.addItem({item:t,data:n,folder:null==s?void 0:s.folder})})).apply(this,arguments)}const ie=(0,h.Ds)(function de(t,n){return R.apply(this,arguments)});function R(){return(R=(0,a.Z)(function*(t,n){yield G(t),ee(t);const s=t.portalItem,o=(0,j.Y)(s),i=yield E(t,o,n),l=yield J(s,[{layer:t,layerJSON:i}]);return I(s),yield s.update({data:l}),(0,P.D)(o),s})).apply(this,arguments)}const ye=(0,h.Ds)(function(){var t=(0,a.Z)(function*(n,s){yield function se(t){return x.apply(this,arguments)}(n);const o=n[0].portalItem,i=(0,j.Y)(o),l=yield Promise.all(n.map(f=>E(f,i,s))),d=yield J(o,n.map((f,c)=>({layer:f,layerJSON:l[c]})));return I(o),yield o.update({data:d}),yield Promise.all(n.slice(1).map(f=>f.portalItem.reload())),(0,P.D)(i),o.clone()});return function(n,s){return t.apply(this,arguments)}}()),fe=(0,h.Ds)(function me(t,n,s){return K.apply(this,arguments)});function K(){return(K=(0,a.Z)(function*(t,n,s){yield G(t);const o=ae(t,n),i=(0,j.Y)(o),l=N({layer:t,layerJSON:yield E(t,i,s)});return yield le(t,o),yield ue(o,l,s),t.portalItem=o,(0,P.D)(i),o})).apply(this,arguments)}},30164:(W,g,e)=>{e.d(g,{T:()=>p});var a=e(15861);const p={BingMapsLayer:(r=(0,a.Z)(function*(){return(yield e.e("node_modules_arcgis_core_layers_BingMapsLayer_js").then(e.bind(e,72248))).default}),function(){return r.apply(this,arguments)}),BuildingSceneLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([e.e("default-node_modules_arcgis_core_layers_mixins_SceneService_js"),e.e("common"),e.e("node_modules_arcgis_core_layers_BuildingSceneLayer_js")]).then(e.bind(e,19319))).default});return function(){return r.apply(this,arguments)}}(),CSVLayer:function(){var r=(0,a.Z)(function*(){return(yield e.e("node_modules_arcgis_core_layers_CSVLayer_js").then(e.bind(e,85625))).default});return function(){return r.apply(this,arguments)}}(),ElevationLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([e.e("common"),e.e("node_modules_arcgis_core_layers_ElevationLayer_js")]).then(e.bind(e,25227))).default});return function(){return r.apply(this,arguments)}}(),FeatureLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.resolve().then(e.bind(e,32258))).default});return function(){return r.apply(this,arguments)}}(),GroupLayer:function(){var r=(0,a.Z)(function*(){return(yield e.e("node_modules_arcgis_core_layers_GroupLayer_js").then(e.bind(e,25964))).default});return function(){return r.apply(this,arguments)}}(),GeoRSSLayer:function(){var r=(0,a.Z)(function*(){return(yield e.e("node_modules_arcgis_core_layers_GeoRSSLayer_js").then(e.bind(e,96306))).default});return function(){return r.apply(this,arguments)}}(),GeoJSONLayer:function(){var r=(0,a.Z)(function*(){return(yield e.e("node_modules_arcgis_core_layers_GeoJSONLayer_js").then(e.bind(e,72903))).default});return function(){return r.apply(this,arguments)}}(),ImageryLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([e.e("default-node_modules_arcgis_core_layers_support_rasterFunctions_pixelUtils_js"),e.e("default-node_modules_arcgis_core_layers_support_rasterFunctions_vectorFieldUtils_js-node_modu-8bb3a8"),e.e("default-node_modules_arcgis_core_layers_support_rasterFormats_RasterCodec_js-node_modules_arc-fe02d7"),e.e("default-node_modules_arcgis_core_layers_support_RasterJobHandler_js-node_modules_arcgis_core_-223bcd"),e.e("node_modules_arcgis_core_layers_ImageryLayer_js")]).then(e.bind(e,49602))).default});return function(){return r.apply(this,arguments)}}(),ImageryTileLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([e.e("default-node_modules_arcgis_core_layers_support_rasterFunctions_pixelUtils_js"),e.e("default-node_modules_arcgis_core_layers_support_rasterFunctions_vectorFieldUtils_js-node_modu-8bb3a8"),e.e("default-node_modules_arcgis_core_layers_support_rasterFunctions_rasterProjectionHelper_js"),e.e("default-node_modules_arcgis_core_layers_support_rasterFormats_RasterCodec_js-node_modules_arc-fe02d7"),e.e("default-node_modules_arcgis_core_layers_support_RasterJobHandler_js-node_modules_arcgis_core_-223bcd"),e.e("common"),e.e("node_modules_arcgis_core_layers_ImageryTileLayer_js")]).then(e.bind(e,23490))).default});return function(){return r.apply(this,arguments)}}(),IntegratedMeshLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([e.e("default-node_modules_arcgis_core_layers_mixins_SceneService_js"),e.e("common"),e.e("node_modules_arcgis_core_layers_IntegratedMeshLayer_js")]).then(e.bind(e,31370))).default});return function(){return r.apply(this,arguments)}}(),KMLLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([e.e("common"),e.e("node_modules_arcgis_core_layers_KMLLayer_js")]).then(e.bind(e,38411))).default});return function(){return r.apply(this,arguments)}}(),LineOfSightLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([e.e("common"),e.e("node_modules_arcgis_core_layers_LineOfSightLayer_js")]).then(e.bind(e,4421))).default});return function(){return r.apply(this,arguments)}}(),MapImageLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([e.e("default-node_modules_arcgis_core_layers_mixins_ArcGISMapService_js-node_modules_arcgis_core_l-f486c2"),e.e("common"),e.e("node_modules_arcgis_core_layers_MapImageLayer_js-node_modules_arcgis_core_layers_support_floo-009052")]).then(e.bind(e,48887))).default});return function(){return r.apply(this,arguments)}}(),MapNotesLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([e.e("common"),e.e("node_modules_arcgis_core_layers_MapNotesLayer_js")]).then(e.bind(e,19859))).default});return function(){return r.apply(this,arguments)}}(),OGCFeatureLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([e.e("default-node_modules_arcgis_core_layers_ogc_ogcFeatureUtils_js"),e.e("node_modules_arcgis_core_layers_OGCFeatureLayer_js-node_modules_arcgis_core_layers_graphics_d-2e45bd")]).then(e.bind(e,36554))).default});return function(){return r.apply(this,arguments)}}(),OpenStreetMapLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([e.e("common"),e.e("node_modules_arcgis_core_layers_OpenStreetMapLayer_js")]).then(e.bind(e,71591))).default});return function(){return r.apply(this,arguments)}}(),PointCloudLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([e.e("default-node_modules_arcgis_core_layers_mixins_SceneService_js"),e.e("common"),e.e("node_modules_arcgis_core_layers_PointCloudLayer_js")]).then(e.bind(e,7155))).default});return function(){return r.apply(this,arguments)}}(),RouteLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([e.e("default-node_modules_arcgis_core_rest_support_DirectionLine_js-node_modules_arcgis_core_rest_-21d156"),e.e("node_modules_arcgis_core_layers_RouteLayer_js")]).then(e.bind(e,68664))).default});return function(){return r.apply(this,arguments)}}(),SceneLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([e.e("default-node_modules_arcgis_core_layers_mixins_SceneService_js"),e.e("common"),e.e("node_modules_arcgis_core_layers_SceneLayer_js")]).then(e.bind(e,27559))).default});return function(){return r.apply(this,arguments)}}(),StreamLayer:function(){var r=(0,a.Z)(function*(){return(yield e.e("node_modules_arcgis_core_layers_StreamLayer_js").then(e.bind(e,70289))).default});return function(){return r.apply(this,arguments)}}(),TileLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([e.e("default-node_modules_arcgis_core_layers_mixins_ArcGISMapService_js-node_modules_arcgis_core_l-f486c2"),e.e("common"),e.e("node_modules_arcgis_core_layers_TileLayer_js")]).then(e.bind(e,59735))).default});return function(){return r.apply(this,arguments)}}(),UnknownLayer:function(){var r=(0,a.Z)(function*(){return(yield e.e("node_modules_arcgis_core_layers_UnknownLayer_js").then(e.bind(e,56339))).default});return function(){return r.apply(this,arguments)}}(),UnsupportedLayer:function(){var r=(0,a.Z)(function*(){return(yield e.e("node_modules_arcgis_core_layers_UnsupportedLayer_js").then(e.bind(e,16240))).default});return function(){return r.apply(this,arguments)}}(),VectorTileLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([e.e("default-node_modules_arcgis_core_views_2d_engine_vectorTiles_style_StyleRepository_js"),e.e("common"),e.e("node_modules_arcgis_core_layers_VectorTileLayer_js-node_modules_arcgis_core_views_2d_engine_v-e60b30")]).then(e.bind(e,14836))).default});return function(){return r.apply(this,arguments)}}(),VoxelLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([e.e("default-node_modules_arcgis_core_layers_mixins_SceneService_js"),e.e("node_modules_arcgis_core_layers_VoxelLayer_js")]).then(e.bind(e,68115))).default});return function(){return r.apply(this,arguments)}}(),WebTileLayer:function(){var r=(0,a.Z)(function*(){return(yield e.e("common").then(e.bind(e,28678))).default});return function(){return r.apply(this,arguments)}}(),WFSLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([e.e("default-node_modules_arcgis_core_layers_ogc_wfsUtils_js"),e.e("node_modules_arcgis_core_layers_WFSLayer_js")]).then(e.bind(e,98762))).default});return function(){return r.apply(this,arguments)}}(),WMSLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([e.e("common"),e.e("node_modules_arcgis_core_layers_WMSLayer_js")]).then(e.bind(e,46894))).default});return function(){return r.apply(this,arguments)}}(),WMTSLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([e.e("common"),e.e("node_modules_arcgis_core_layers_WMTSLayer_js")]).then(e.bind(e,64223))).default});return function(){return r.apply(this,arguments)}}()};var r},88755:(W,g,e)=>{e.d(g,{Y:()=>u,h:()=>r});var a=e(21726),p=e(84687);function r(y){return{origin:"portal-item",url:(0,a.mN)(y.itemUrl),portal:y.portal||p.Z.getDefault(),portalItem:y,readResourcePaths:[]}}function u(y){return{origin:"portal-item",messages:[],writtenProperties:[],url:y.itemUrl?(0,a.mN)(y.itemUrl):null,portal:y.portal||p.Z.getDefault(),portalItem:y}}}}]);
"use strict";var V=Object.defineProperty,N=Object.defineProperties,X=Object.getOwnPropertyDescriptors,Z=Object.getOwnPropertySymbols,Y=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable,Q=(E,f,s)=>f in E?V(E,f,{enumerable:!0,configurable:!0,writable:!0,value:s}):E[f]=s,U=(E,f)=>{for(var s in f||(f={}))Y.call(f,s)&&Q(E,s,f[s]);if(Z)for(var s of Z(f))k.call(f,s)&&Q(E,s,f[s]);return E},K=(E,f)=>N(E,X(f));(self.webpackChunkdemo2=self.webpackChunkdemo2||[]).push([[7728],{7728:(E,f,s)=>{s.r(f),s.d(f,{default:()=>H});var v=s(15861),T=s(26584),M=s(62208),I=s(91179),A=s(37053),b=s(82054),C=s(1476),x=s(82708),D=s(82959),S=s(58175),h=s(56554),l=s(35775),R=s(60466),W=s(85),j=s(36630);const $=A.Zn,q={xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:A.Zn},G={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsStatistics:!0,supportsPercentileStatistics:!0,supportsReturningGeometryCentroid:!0,supportsQueryWithDistance:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQueryWithResultType:!1,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0}};function z(O){return(0,I.wp)(O)?null!=O.m:!!O.hasM}class H{constructor(){this._queryEngine=null,this._nextObjectId=null}destroy(){this._queryEngine&&this._queryEngine&&this._queryEngine.destroy(),this._queryEngine=this._fieldsIndex=this._createDefaultAttributes=null}load(e){var t=this;return(0,v.Z)(function*(){const n=[],{features:r}=e,u=t._inferLayerProperties(r,e.fields),d=e.fields||[],g=null!=e.hasM?e.hasM:u.hasM,m=null!=e.hasZ?e.hasZ:u.hasZ,p=!e.spatialReference&&!u.spatialReference,a=p?$:e.spatialReference||u.spatialReference,o=p?q:null,_=e.geometryType||u.geometryType;let c=e.objectIdField||u.objectIdField,y=e.timeInfo;if(_&&(p&&n.push({name:"feature-layer:spatial-reference-not-found",message:"Spatial reference not provided or found in features. Defaults to WGS84"}),!_))throw new T.Z("feature-layer:missing-property","geometryType not set and couldn't be inferred from the provided features");if(!c)throw new T.Z("feature-layer:missing-property","objectIdField not set and couldn't be found in the provided fields");if(u.objectIdField&&c!==u.objectIdField&&(n.push({name:"feature-layer:duplicated-oid-field",message:`Provided objectIdField "${c}" doesn't match the field name "${u.objectIdField}", found in the provided fields`}),c=u.objectIdField),c&&!u.objectIdField){let i=null;d.some(P=>P.name===c&&(i=P,!0))?(i.type="esriFieldTypeOID",i.editable=!1,i.nullable=!1):d.unshift({alias:c,name:c,type:"esriFieldTypeOID",editable:!1,nullable:!1})}for(const i of d){if(null==i.name&&(i.name=i.alias),null==i.alias&&(i.alias=i.name),!i.name)throw new T.Z("feature-layer:invalid-field-name","field name is missing",{field:i});if(i.name===c&&(i.type="esriFieldTypeOID"),!W.v.jsonValues.includes(i.type))throw new T.Z("feature-layer:invalid-field-type",`invalid type for field "${i.name}"`,{field:i})}const B={};for(const i of d)if("esriFieldTypeOID"!==i.type&&"esriFieldTypeGlobalID"!==i.type){const P=(0,j.os)(i);void 0!==P&&(B[i.name]=P)}if(t._fieldsIndex=new R.Z(d),t._createDefaultAttributes=(0,h.Dm)(B,c),y){if(y.startTimeField){const i=t._fieldsIndex.get(y.startTimeField);i?(y.startTimeField=i.name,i.type="esriFieldTypeDate"):y.startTimeField=null}if(y.endTimeField){const i=t._fieldsIndex.get(y.endTimeField);i?(y.endTimeField=i.name,i.type="esriFieldTypeDate"):y.endTimeField=null}if(y.trackIdField){const i=t._fieldsIndex.get(y.trackIdField);i?y.trackIdField=i.name:(y.trackIdField=null,n.push({name:"feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:y}}))}y.startTimeField||y.endTimeField||(n.push({name:"feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing or invalid",details:{timeInfo:y}}),y=null)}const L={warnings:n,featureErrors:[],layerDefinition:K(U({},G),{drawingInfo:(0,h.bU)(_),templates:(0,h.Hq)(B),extent:o,geometryType:_,objectIdField:c,fields:d,hasZ:!!m,hasM:!!g,timeInfo:y}),assignedObjectIds:{}};if(t._queryEngine=new S.q({fields:d,geometryType:_,hasM:g,hasZ:m,objectIdField:c,spatialReference:a,featureStore:new x.Z({geometryType:_,hasM:g,hasZ:m}),timeInfo:y,cacheSpatialQueries:!0}),!r||!r.length)return t._nextObjectId=C.X,L;const J=(0,C.S)(c,r);return t._nextObjectId=J+1,yield(0,D._W)(r,a),t._loadInitialFeatures(L,r)})()}applyEdits(e){var t=this;return(0,v.Z)(function*(){const{spatialReference:n,geometryType:r}=t._queryEngine;return yield Promise.all([(0,l.b)(n,r),(0,D._W)(e.adds,n),(0,D._W)(e.updates,n)]),t._applyEdits(e)})()}queryFeatures(e,t={}){return this._queryEngine.executeQuery(e,t.signal)}queryFeatureCount(e,t={}){return this._queryEngine.executeQueryForCount(e,t.signal)}queryObjectIds(e,t={}){return this._queryEngine.executeQueryForIds(e,t.signal)}queryExtent(e,t={}){return this._queryEngine.executeQueryForExtent(e,t.signal)}querySnapping(e,t={}){return this._queryEngine.executeQueryForSnapping(e,t.signal)}_inferLayerProperties(e,t){let n,r,u=null,d=null,g=null;for(const m of e){const p=m.geometry;if(!(0,M.Wi)(p)&&(u||(u=(0,I.Ji)(p)),d||(d=p.spatialReference),null==n&&(n=(0,I.wp)(O=p)?null!=O.z:!!O.hasZ),null==r&&(r=z(p)),u&&d&&null!=n&&null!=r))break}var O;if(t&&t.length){let m=null;t.some(p=>{const a="esriFieldTypeOID"===p.type,o=!p.type&&p.name&&"objectid"===p.name.toLowerCase();return m=p,a||o})&&(g=m.name)}return{geometryType:u,spatialReference:d,objectIdField:g,hasM:r,hasZ:n}}_loadInitialFeatures(e,t){const{geometryType:n,hasM:r,hasZ:u,objectIdField:d,spatialReference:g,featureStore:m}=this._queryEngine,p=[];for(const a of t){if(null!=a.uid&&(e.assignedObjectIds[a.uid]=-1),a.geometry&&n!==(0,I.Ji)(a.geometry)){e.featureErrors.push((0,l.av)("Incorrect geometry type."));continue}const o=this._createDefaultAttributes(),_=(0,l.O0)(this._fieldsIndex,o,a.attributes,!0,e.warnings);_?e.featureErrors.push(_):(this._assignObjectId(o,a.attributes,!0),a.attributes=o,null!=a.uid&&(e.assignedObjectIds[a.uid]=a.attributes[d]),(0,M.pC)(a.geometry)&&(a.geometry=(0,D.iV)(a.geometry,a.geometry.spatialReference,g)),p.push(a))}if(m.addMany((0,b.Yn)([],p,n,u,r,d)),e.layerDefinition.extent=this._queryEngine.fullExtent,e.layerDefinition.timeInfo){const{start:a,end:o}=this._queryEngine.timeExtent;e.layerDefinition.timeInfo.timeExtent=[a,o]}return e}_applyEdits(e){const{adds:t,updates:n,deletes:r}=e,u={addResults:[],deleteResults:[],updateResults:[],uidToObjectId:{}};if(t&&t.length&&this._applyAddEdits(u,t),n&&n.length&&this._applyUpdateEdits(u,n),r&&r.length){for(const d of r)u.deleteResults.push((0,l.d1)(d));this._queryEngine.featureStore.removeManyById(r)}return{fullExtent:this._queryEngine.fullExtent,featureEditResults:u}}_applyAddEdits(e,t){const{addResults:n}=e,{geometryType:r,hasM:u,hasZ:d,objectIdField:g,spatialReference:m,featureStore:p}=this._queryEngine,a=[];for(const o of t){if(o.geometry&&r!==(0,I.Ji)(o.geometry)){n.push((0,l.av)("Incorrect geometry type."));continue}const _=this._createDefaultAttributes(),F=(0,l.O0)(this._fieldsIndex,_,o.attributes);F?n.push(F):(this._assignObjectId(_,o.attributes),o.attributes=_,null!=o.uid&&(e.uidToObjectId[o.uid]=o.attributes[g]),(0,M.pC)(o.geometry)&&(o.geometry=(0,D.iV)((0,l.og)(o.geometry,m),o.geometry.spatialReference,m)),a.push(o),n.push((0,l.d1)(o.attributes[g])))}p.addMany((0,b.Yn)([],a,r,d,u,g))}_applyUpdateEdits({updateResults:e},t){const{geometryType:n,hasM:r,hasZ:u,objectIdField:d,spatialReference:g,featureStore:m}=this._queryEngine;for(const p of t){const{attributes:a,geometry:o}=p,_=a&&a[d];if(null==_){e.push((0,l.av)(`Identifier field ${d} missing`));continue}if(!m.has(_)){e.push((0,l.av)(`Feature with object id ${_} missing`));continue}const F=(0,b.EI)(m.getFeature(_),n,u,r);if((0,M.pC)(o)){if(n!==(0,I.Ji)(o)){e.push((0,l.av)("Incorrect geometry type."));continue}F.geometry=(0,D.iV)((0,l.og)(o,g),o.spatialReference,g)}if(a){const c=(0,l.O0)(this._fieldsIndex,F.attributes,a);if(c){e.push(c);continue}}m.add((0,b.XA)(F,n,u,r,d)),e.push((0,l.d1)(_))}}_assignObjectId(e,t,n=!1){const r=this._queryEngine.objectIdField;e[r]=n&&t&&isFinite(t[r])?t[r]:this._nextObjectId++}}},56554:(E,f,s)=>{s.d(f,{Dm:()=>x,Hq:()=>D,MS:()=>S,bU:()=>A});var v=s(8314),T=s(58817),M=s(87757),I=s(24837);function A(h){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===h||"esriGeometryMultipoint"===h?I.I4:"esriGeometryPolyline"===h?I.ET:I.lF}}}const b=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let C=1;function x(h,l){if((0,v.Z)("esri-csp-restrictions"))return()=>U({[l]:null},h);try{let R=`this.${l} = null;`;for(const j in h)R+=`this${b.test(j)?`.${j}`:`["${j}"]`} = ${JSON.stringify(h[j])};`;const W=new Function(`\n      return class AttributesClass$${C++} {\n        constructor() {\n          ${R};\n        }\n      }\n    `)();return()=>new W}catch(R){return()=>U({[l]:null},h)}}function D(h={}){return[{name:"New Feature",description:"",prototype:{attributes:(0,T.d9)(h)}}]}function S(h,l){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:h},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:l,supportsDelete:l,supportsEditing:l,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:l,supportsExceedsLimitStatistics:!0},query:M.g,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:l,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1}}}}}]);
"use strict";(self.webpackChunkdemo2=self.webpackChunkdemo2||[]).push([[6533,164],{36912:(j,p,t)=>{t.r(p),t.d(p,{save:()=>it,saveAll:()=>yt,saveAs:()=>dt});var o=t(15861),L=t(85931),e=t(26584),u=t(63290),y=t(62208),g=t(10699),P=t(52489),Q=t(32258),X=t(24578),b=t(38305),B=t(72469),w=t(84687),k=t(55463),E=t(88755),m=t(37281);const q=u.Z.getLogger("esri.layers.FeatureLayer"),v="Feature Service";function c(n,r){return`Layer (title: ${n.title}, id: ${n.id}) of type '${n.declaredClass}' ${r}`}function N(n,r){if(r.type!==v)throw new e.Z("feature-layer:portal-item-wrong-type",c(n,`should have portal item of type "${v}"`))}function F(n){return I.apply(this,arguments)}function I(){return(I=(0,o.Z)(function*(n){if(yield n.load(),(0,B.rQ)(n))throw new e.Z("feature-layer:save",c(n,"using an in-memory source cannot be saved to a portal item"))})).apply(this,arguments)}function _(n,r){let l=n.messages.filter(({type:a})=>"error"===a).map(({name:a,message:i,details:s})=>new e.Z(a,i,s));if(null!=r&&r.ignoreUnsupported&&(l=l.filter(({name:a})=>"layer:unsupported"!==a&&"symbol:unsupported"!==a&&"symbol-layer:unsupported"!==a&&"property:unsupported"!==a&&"url:unsupported"!==a)),l.length>0)throw new e.Z("feature-layer:save","Failed to save feature layer due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:l})}function M(n,r,l){return D.apply(this,arguments)}function D(){return(D=(0,o.Z)(function*(n,r,l){"beforeSave"in n&&"function"==typeof n.beforeSave&&(yield n.beforeSave());const a=n.write({},r);return _(r,l),a})).apply(this,arguments)}function J(n){const{layer:r,layerJSON:l}=n;return r.isTable?{layers:[],tables:[l]}:{layers:[l],tables:[]}}function Z(n){(0,m.qj)(n,m.Kz.JSAPI),n.typeKeywords&&(n.typeKeywords=n.typeKeywords.filter((r,l,a)=>a.indexOf(r)===l))}function tt(n){const r=n.portalItem;if(!r)throw q.error("save: requires the portalItem property to be set"),new e.Z("feature-layer:portal-item-not-set",c(n,"requires the portalItem property to be set"));if(!r.loaded)throw new e.Z("feature-layer:portal-item-not-loaded",c(n,"cannot be saved to a portal item that does not exist or is inaccessible"));N(n,r)}function G(n,r){return O.apply(this,arguments)}function O(){return(O=(0,o.Z)(function*(n,r){return/\/\d+\/?$/.test(n.url)?J(r[0]):nt(n,r)})).apply(this,arguments)}function nt(n,r){return S.apply(this,arguments)}function S(){return(S=(0,o.Z)(function*(n,r){const{layer:{url:l,customParameters:a,apiKey:i}}=r[0];let s=yield n.fetchData("json");s&&null!=s.layers&&null!=s.tables||(s=yield rt(s,{url:l,customParameters:a,apiKey:i},r.map(f=>f.layer.layerId)));for(const f of r)z(f.layer,f.layerJSON,s);return s})).apply(this,arguments)}function rt(n,r,l){return T.apply(this,arguments)}function T(){return(T=(0,o.Z)(function*(n,r,l){var a,i;n||(n={}),(a=n).layers||(a.layers=[]),(i=n).tables||(i.tables=[]);const{url:s,customParameters:f,apiKey:d}=r,{serviceJSON:h,layersJSON:W}=yield(0,X.fetchFeatureService)(s,{customParameters:f,apiKey:d}),V=$(n.layers,h.layers,l),H=$(n.tables,h.tables,l);n.layers=V.itemResources,n.tables=H.itemResources;const ht=[...V.added,...H.added],pt=W?[...W.layers,...W.tables]:[];return yield et(n,ht,s,pt),n})).apply(this,arguments)}function $(n,r,l){const a=(0,L.e5)(n,r,(s,f)=>s.id===f.id);n=n.filter(s=>!a.removed.some(f=>f.id===s.id));const i=a.added.map(({id:s})=>({id:s}));return i.forEach(({id:s})=>{n.push({id:s})}),{itemResources:n,added:i.filter(({id:s})=>!l.includes(s))}}function et(n,r,l,a){return x.apply(this,arguments)}function x(){return(x=(0,o.Z)(function*(n,r,l,a){const i=r.map(({id:s})=>new Q.default({url:l,layerId:s,sourceJSON:a.find(({id:f})=>f===s)}));yield(0,g.as)(i.map(s=>s.load())),i.forEach(s=>{const{layerId:f,loaded:d,defaultPopupTemplate:h}=s;!d||(0,y.Wi)(h)||z(s,{id:f,popupInfo:h.toJSON()},n)})})).apply(this,arguments)}function z(n,r,l){!function Y(n,r){const l=n.findIndex(({id:a})=>a===r.id);-1===l?n.push(r):n[l]=r}(n.isTable?l.tables:l.layers,r)}function at(n){const{portalItem:r}=n;return(0,B.y2)(n)&&!n.dynamicDataSource&&!(null==r||!r.loaded)&&r.type===v}function U(){return(U=(0,o.Z)(function*(n){if(null==n||!n.length)throw new e.Z("feature-layer-utils-saveall:missing-parameters","'layers' array should contain at least one feature layer");yield Promise.all(n.map(a=>a.load()));for(const a of n)if(!at(a))throw new e.Z("feature-layer-utils-saveall:invalid-parameters",`'layers' array should only contain layers or tables in a feature service loaded from 'Feature Service' item. ${c(a,"does not conform")}`,{layer:a});const r=n.map(a=>a.portalItem.id);if(new Set(r).size>1)throw new e.Z("feature-layer-utils-saveall:invalid-parameters","All layers in the 'layers' array should be loaded from the same portal item");const l=n.map(a=>a.layerId);if(new Set(l).size!==l.length)throw new e.Z("feature-layer-utils-saveall:invalid-parameters","'layers' array should contain only one instance each of layer or table in a feature service")})).apply(this,arguments)}function ot(n,r){var l,a;let i=k.default.from(r);return i.id&&(i=i.clone(),i.id=null),null!=(l=i).type||(l.type=v),null!=(a=i).portal||(a.portal=w.Z.getDefault()),N(n,i),i}function st(n,r){return K.apply(this,arguments)}function K(){return(K=(0,o.Z)(function*(n,r){const{url:l,layerId:a,title:i,fullExtent:s,isTable:f}=n,d=(0,b.Qc)(l),h=(0,y.pC)(d)&&"FeatureServer"===d.serverType;r.url=h?l:`${l}/${a}`,r.title||(r.title=i),r.extent=null,!f&&(0,y.pC)(s)&&(r.extent=yield(0,m.$o)(s)),(0,m.ck)(r,m.Kz.METADATA),(0,m.ck)(r,m.Kz.MULTI_LAYER),(0,m.qj)(r,m.Kz.SINGLE_LAYER),f&&(0,m.qj)(r,m.Kz.TABLE),Z(r)})).apply(this,arguments)}function ut(n,r,l){return A.apply(this,arguments)}function A(){return(A=(0,o.Z)(function*(n,r,l){const a=n.portal;yield a._signIn(),yield a.user.addItem({item:n,data:r,folder:null==l?void 0:l.folder})})).apply(this,arguments)}const it=(0,g.Ds)(function ft(n,r){return C.apply(this,arguments)});function C(){return(C=(0,o.Z)(function*(n,r){yield F(n),tt(n);const l=n.portalItem,a=(0,E.Y)(l),i=yield M(n,a,r),s=yield G(l,[{layer:n,layerJSON:i}]);return Z(l),yield l.update({data:s}),(0,P.D)(a),l})).apply(this,arguments)}const yt=(0,g.Ds)(function(){var n=(0,o.Z)(function*(r,l){yield function lt(n){return U.apply(this,arguments)}(r);const a=r[0].portalItem,i=(0,E.Y)(a),s=yield Promise.all(r.map(d=>M(d,i,l))),f=yield G(a,r.map((d,h)=>({layer:d,layerJSON:s[h]})));return Z(a),yield a.update({data:f}),yield Promise.all(r.slice(1).map(d=>d.portalItem.reload())),(0,P.D)(i),a.clone()});return function(r,l){return n.apply(this,arguments)}}()),dt=(0,g.Ds)(function mt(n,r,l){return R.apply(this,arguments)});function R(){return(R=(0,o.Z)(function*(n,r,l){yield F(n);const a=ot(n,r),i=(0,E.Y)(a),s=J({layer:n,layerJSON:yield M(n,i,l)});return yield st(n,a),yield ut(a,s,l),n.portalItem=a,(0,P.D)(i),a})).apply(this,arguments)}},30164:(j,p,t)=>{t.d(p,{T:()=>L});var o=t(15861);const L={BingMapsLayer:(e=(0,o.Z)(function*(){return(yield t.e(2248).then(t.bind(t,72248))).default}),function(){return e.apply(this,arguments)}),BuildingSceneLayer:function(){var e=(0,o.Z)(function*(){return(yield Promise.all([t.e(157),t.e(8592),t.e(9319)]).then(t.bind(t,19319))).default});return function(){return e.apply(this,arguments)}}(),CSVLayer:function(){var e=(0,o.Z)(function*(){return(yield t.e(5625).then(t.bind(t,85625))).default});return function(){return e.apply(this,arguments)}}(),ElevationLayer:function(){var e=(0,o.Z)(function*(){return(yield Promise.all([t.e(8592),t.e(5227)]).then(t.bind(t,25227))).default});return function(){return e.apply(this,arguments)}}(),FeatureLayer:function(){var e=(0,o.Z)(function*(){return(yield Promise.resolve().then(t.bind(t,32258))).default});return function(){return e.apply(this,arguments)}}(),GroupLayer:function(){var e=(0,o.Z)(function*(){return(yield t.e(5964).then(t.bind(t,25964))).default});return function(){return e.apply(this,arguments)}}(),GeoRSSLayer:function(){var e=(0,o.Z)(function*(){return(yield t.e(6306).then(t.bind(t,96306))).default});return function(){return e.apply(this,arguments)}}(),GeoJSONLayer:function(){var e=(0,o.Z)(function*(){return(yield t.e(2903).then(t.bind(t,72903))).default});return function(){return e.apply(this,arguments)}}(),ImageryLayer:function(){var e=(0,o.Z)(function*(){return(yield Promise.all([t.e(7692),t.e(6926),t.e(581),t.e(3016),t.e(9602)]).then(t.bind(t,49602))).default});return function(){return e.apply(this,arguments)}}(),ImageryTileLayer:function(){var e=(0,o.Z)(function*(){return(yield Promise.all([t.e(7692),t.e(6926),t.e(8594),t.e(581),t.e(3016),t.e(8592),t.e(3490)]).then(t.bind(t,23490))).default});return function(){return e.apply(this,arguments)}}(),IntegratedMeshLayer:function(){var e=(0,o.Z)(function*(){return(yield Promise.all([t.e(157),t.e(8592),t.e(1370)]).then(t.bind(t,31370))).default});return function(){return e.apply(this,arguments)}}(),KMLLayer:function(){var e=(0,o.Z)(function*(){return(yield Promise.all([t.e(8592),t.e(8411)]).then(t.bind(t,38411))).default});return function(){return e.apply(this,arguments)}}(),LineOfSightLayer:function(){var e=(0,o.Z)(function*(){return(yield Promise.all([t.e(8592),t.e(4421)]).then(t.bind(t,4421))).default});return function(){return e.apply(this,arguments)}}(),MapImageLayer:function(){var e=(0,o.Z)(function*(){return(yield Promise.all([t.e(3130),t.e(8592),t.e(7948)]).then(t.bind(t,48887))).default});return function(){return e.apply(this,arguments)}}(),MapNotesLayer:function(){var e=(0,o.Z)(function*(){return(yield Promise.all([t.e(8592),t.e(9859)]).then(t.bind(t,19859))).default});return function(){return e.apply(this,arguments)}}(),OGCFeatureLayer:function(){var e=(0,o.Z)(function*(){return(yield Promise.all([t.e(9628),t.e(2955)]).then(t.bind(t,36554))).default});return function(){return e.apply(this,arguments)}}(),OpenStreetMapLayer:function(){var e=(0,o.Z)(function*(){return(yield Promise.all([t.e(8592),t.e(1591)]).then(t.bind(t,71591))).default});return function(){return e.apply(this,arguments)}}(),PointCloudLayer:function(){var e=(0,o.Z)(function*(){return(yield Promise.all([t.e(157),t.e(8592),t.e(7155)]).then(t.bind(t,7155))).default});return function(){return e.apply(this,arguments)}}(),RouteLayer:function(){var e=(0,o.Z)(function*(){return(yield Promise.all([t.e(403),t.e(8664)]).then(t.bind(t,68664))).default});return function(){return e.apply(this,arguments)}}(),SceneLayer:function(){var e=(0,o.Z)(function*(){return(yield Promise.all([t.e(157),t.e(8592),t.e(7559)]).then(t.bind(t,27559))).default});return function(){return e.apply(this,arguments)}}(),StreamLayer:function(){var e=(0,o.Z)(function*(){return(yield t.e(289).then(t.bind(t,70289))).default});return function(){return e.apply(this,arguments)}}(),TileLayer:function(){var e=(0,o.Z)(function*(){return(yield Promise.all([t.e(3130),t.e(8592),t.e(9735)]).then(t.bind(t,59735))).default});return function(){return e.apply(this,arguments)}}(),UnknownLayer:function(){var e=(0,o.Z)(function*(){return(yield t.e(6339).then(t.bind(t,56339))).default});return function(){return e.apply(this,arguments)}}(),UnsupportedLayer:function(){var e=(0,o.Z)(function*(){return(yield t.e(6240).then(t.bind(t,16240))).default});return function(){return e.apply(this,arguments)}}(),VectorTileLayer:function(){var e=(0,o.Z)(function*(){return(yield Promise.all([t.e(8364),t.e(8592),t.e(4895)]).then(t.bind(t,14836))).default});return function(){return e.apply(this,arguments)}}(),VoxelLayer:function(){var e=(0,o.Z)(function*(){return(yield Promise.all([t.e(157),t.e(8115)]).then(t.bind(t,68115))).default});return function(){return e.apply(this,arguments)}}(),WebTileLayer:function(){var e=(0,o.Z)(function*(){return(yield t.e(8592).then(t.bind(t,28678))).default});return function(){return e.apply(this,arguments)}}(),WFSLayer:function(){var e=(0,o.Z)(function*(){return(yield Promise.all([t.e(3774),t.e(8762)]).then(t.bind(t,98762))).default});return function(){return e.apply(this,arguments)}}(),WMSLayer:function(){var e=(0,o.Z)(function*(){return(yield Promise.all([t.e(8592),t.e(6894)]).then(t.bind(t,46894))).default});return function(){return e.apply(this,arguments)}}(),WMTSLayer:function(){var e=(0,o.Z)(function*(){return(yield Promise.all([t.e(8592),t.e(4223)]).then(t.bind(t,64223))).default});return function(){return e.apply(this,arguments)}}()};var e},88755:(j,p,t)=>{t.d(p,{Y:()=>u,h:()=>e});var o=t(21726),L=t(84687);function e(y){return{origin:"portal-item",url:(0,o.mN)(y.itemUrl),portal:y.portal||L.Z.getDefault(),portalItem:y,readResourcePaths:[]}}function u(y){return{origin:"portal-item",messages:[],writtenProperties:[],url:y.itemUrl?(0,o.mN)(y.itemUrl):null,portal:y.portal||L.Z.getDefault(),portalItem:y}}}}]);
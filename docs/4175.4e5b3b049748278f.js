"use strict";var te=Object.defineProperty,ee=Object.defineProperties,oe=Object.getOwnPropertyDescriptors,Yt=Object.getOwnPropertySymbols,ie=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable,Ft=(rt,U,_)=>U in rt?te(rt,U,{enumerable:!0,configurable:!0,writable:!0,value:_}):rt[U]=_,Rt=(rt,U)=>{for(var _ in U||(U={}))ie.call(U,_)&&Ft(rt,_,U[_]);if(Yt)for(var _ of Yt(U))ne.call(U,_)&&Ft(rt,_,U[_]);return rt},Ut=(rt,U)=>ee(rt,oe(U));(self.webpackChunkdemo2=self.webpackChunkdemo2||[]).push([[4175],{47139:(rt,U,_)=>{_.d(U,{Fp:()=>ct,RL:()=>z,UV:()=>k,bk:()=>d});var lt=_(36161),at=_(91179),Z=_(31375);function ct(m){var v;if(!m)return null;switch(m.type){case"CIMPointSymbol":{const M=m.symbolLayers;return M&&1===M.length?ct(M[0]):null}case"CIMVectorMarker":{const M=m.markerGraphics;if(!M||1!==M.length)return null;const O=M[0];if(!O)return null;const I=O.geometry;if(!I)return null;const C=O.symbol;return!C||"CIMPolygonSymbol"!==C.type&&"CIMLineSymbol"!==C.type||(null==(v=C.symbolLayers)?void 0:v.some(A=>!!A.effects))?null:{geom:I,asFill:"CIMPolygonSymbol"===C.type}}case"sdf":return{geom:m.geom,asFill:m.asFill}}return null}function N(m){let v=1/0,M=-1/0,O=1/0,I=-1/0;for(const C of m)for(const A of C)A[0]<v&&(v=A[0]),A[0]>M&&(M=A[0]),A[1]<O&&(O=A[1]),A[1]>I&&(I=A[1]);return[v,O,M,I]}function d(m){return m?m.rings?N(m.rings):m.paths?N(m.paths):(0,at.YX)(m)?[m.xmin,m.ymin,m.xmax,m.ymax]:null:null}function k(m,v,M,O,I){const[C,A,T,j]=m;if(T<C||j<A)return[0,0,0];const B=T-C,D=j-A,H=Math.floor(31.5),J=(128-2*(H+1))/Math.max(B,D),et=Math.round(B*J)+2*H,pt=Math.round(D*J)+2*H;let yt=1;v&&(yt=pt/J/(v.ymax-v.ymin));let Y=0,K=0;return O&&(I?v&&M&&v.ymax-v.ymin>0&&(Y=O.x/(M*((v.xmax-v.xmin)/(v.ymax-v.ymin))),K=O.y/M):(Y=O.x,K=O.y)),Y=.5*(v.xmax+v.xmin)+Y*(v.xmax-v.xmin),K=.5*(v.ymax+v.ymin)+K*(v.ymax-v.ymin),Y-=C,K-=A,Y*=J,K*=J,Y+=H,K+=H,[yt,Y/et-.5,-(K/pt-.5)]}function z(m){const v=function ot(m){return m?m.rings?m.rings:m.paths?m.paths:void 0!==m.xmin&&void 0!==m.ymin&&void 0!==m.xmax&&void 0!==m.ymax?[[[m.xmin,m.ymin],[m.xmin,m.ymax],[m.xmax,m.ymax],[m.xmax,m.ymin],[m.xmin,m.ymin]]]:null:null}(m.geom),M=function L(m){let v=1/0,M=-1/0,O=1/0,I=-1/0;for(const C of m)for(const A of C)A[0]<v&&(v=A[0]),A[0]>M&&(M=A[0]),A[1]<O&&(O=A[1]),A[1]>I&&(I=A[1]);return new Z.Z(v,O,M-v,I-O)}(v),C=Math.floor(31.5),A=(128-2*(C+1))/Math.max(M.width,M.height),T=Math.round(M.width*A)+2*C,j=Math.round(M.height*A)+2*C,B=[];for(const X of v)if(X&&X.length>1){const $=[];for(const H of X){let[J,et]=H;J-=M.x,et-=M.y,J*=A,et*=A,J+=C-.5,et+=C-.5,$.push(m.asFill?[J,et]:[Math.round(J),Math.round(et)])}if(m.asFill){const H=$.length-1;$[0][0]===$[H][0]&&$[0][1]===$[H][1]||$.push($[0])}B.push($)}const D=function c(m,v,M,O){const I=v*M,C=new Array(I),A=O*O+1;for(let T=0;T<I;++T)C[T]=A;for(const T of m){const j=T.length;for(let B=1;B<j;++B){const D=T[B-1],X=T[B];let $,H,J,et;D[0]<X[0]?($=D[0],H=X[0]):($=X[0],H=D[0]),D[1]<X[1]?(J=D[1],et=X[1]):(J=X[1],et=D[1]);let pt=Math.floor($)-O,yt=Math.floor(H)+O,Y=Math.floor(J)-O,K=Math.floor(et)+O;pt<0&&(pt=0),yt>v&&(yt=v),Y<0&&(Y=0),K>M&&(K=M);const G=X[0]-D[0],It=X[1]-D[1],kt=G*G+It*It;for(let _t=pt;_t<yt;_t++)for(let vt=Y;vt<K;vt++){let Ot,Nt,Pt=(_t-D[0])*G+(vt-D[1])*It;Pt<0?(Ot=D[0],Nt=D[1]):Pt>kt?(Ot=X[0],Nt=X[1]):(Pt/=kt,Ot=D[0]+Pt*G,Nt=D[1]+Pt*It);const Dt=(_t-Ot)*(_t-Ot)+(vt-Nt)*(vt-Nt),zt=(M-vt-1)*v+_t;Dt<C[zt]&&(C[zt]=Dt)}}}for(let T=0;T<I;++T)C[T]=Math.sqrt(C[T]);return C}(B,T,j,C);return m.asFill&&function x(m,v,M,O,I){for(const C of m){const A=C.length;for(let T=1;T<A;++T){const j=C[T-1],B=C[T];let D,X,$,H;j[0]<B[0]?(D=j[0],X=B[0]):(D=B[0],X=j[0]),j[1]<B[1]?($=j[1],H=B[1]):($=B[1],H=j[1]);let J=Math.floor(D),et=Math.floor(X)+1,pt=Math.floor($),yt=Math.floor(H)+1;J<O&&(J=O),et>v-O&&(et=v-O),pt<O&&(pt=O),yt>M-O&&(yt=M-O);for(let Y=pt;Y<yt;++Y){if(j[1]>Y==B[1]>Y)continue;const K=(M-Y-1)*v;for(let G=J;G<et;++G)G<(B[0]-j[0])*(Y-j[1])/(B[1]-j[1])+j[0]&&(I[K+G]=-I[K+G]);for(let G=O;G<J;++G)I[K+G]=-I[K+G]}}}}(B,T,j,C,D),[tt(D,C),T,j]}function tt(m,v){const M=2*v,O=m.length,I=new Uint8Array(4*O);for(let C=0;C<O;++C)(0,lt.I)(.5-m[C]/M,I,4*C);return I}},84175:(rt,U,_)=>{_.d(U,{S:()=>Zt,c:()=>$});var lt=_(15861),at=_(91558),Z=_(58817),ct=_(63290),V=_(62208),ot=_(23841),L=_(77275),N=_(46679),d=_(35909),k=_(7547),z=_(47139),c=_(80991),x=_(73608),tt=_(39236),m=_(39351),v=_(21411),M=_(3959);const O=ct.Z.getLogger("esri.symbols.cim.cimAnalyzer");function I(t){switch(t){case"Butt":return k.RL.BUTT;case"Square":return k.RL.SQUARE;default:return k.RL.ROUND}}function C(t){switch(t){case"Bevel":return k.AH.BEVEL;case"Miter":return k.AH.MITER;default:return k.AH.ROUND}}function A(t){switch(t){case"Left":default:return"left";case"Right":return"right";case"Center":return"center";case"Justify":return O.warnOnce("Horizontal alignment 'justify' is not implemented. Falling back to 'center'."),"center"}}function T(t){switch(t){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function D(t,i,o,l){let e;t[i]?e=t[i]:(e={},t[i]=e),e[o]=l}function X(t){const i=t.markerPlacement;return i&&i.angleToLine?k.v2.MAP:k.v2.SCREEN}function $(t,i,o,l,e){return H.apply(this,arguments)}function H(){return(H=(0,lt.Z)(function*(t,i,o,l,e){const a=null!=l?l:[];if(!t)return a;let s,n;const r={};if("CIMSymbolReference"!==t.type)return O.error("Expect cim type to be 'CIMSymbolReference'"),a;if(s=t.symbol,n=t.primitiveOverrides,n){const u=[];for(const g of n){const p=g.valueExpressionInfo;if(p&&i){const b=(0,N.Yi)(p.expression,i.spatialReference,i.fields).then(S=>{S&&D(r,g.primitiveName,g.propertyName,S)});u.push(b)}else null!=g.value&&D(r,g.primitiveName,g.propertyName,g.value)}u.length>0&&(yield Promise.all(u))}const f=[];switch(Ht(s,o,f),f.length>0&&(yield Promise.all(f)),s.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":J(s,n,r,i,a,o,e)}return a})).apply(this,arguments)}function J(t,i,o,l,e,a,s){if(!t)return;const n=t.symbolLayers;if(!n)return;const r=t.effects;let f;const u=d.B$.getSize(t);"CIMPointSymbol"===t.type&&"Map"===t.angleAlignment&&(f=k.v2.MAP);let g=n.length;for(;g--;){const p=n[g];if(!p||!1===p.enable)continue;let y;r&&r.length&&(y=[...r]);const b=p.effects;b&&b.length&&(r?y.push(...b):y=[...b]);const S=[];let P;d.E0.findEffectOverrides(y,i,S),P=S.length>0?Kt(y,S,o,l):y;const E=[];switch(d.E0.findApplicableOverrides(p,i,E),p.type){case"CIMSolidFill":et(p,P,o,E,l,e);break;case"CIMPictureFill":pt(p,P,o,E,l,a,e);break;case"CIMHatchFill":yt(p,P,o,E,l,e);break;case"CIMGradientFill":Y(p,P,o,E,l,e);break;case"CIMSolidStroke":K(p,P,o,E,l,e,"CIMPolygonSymbol"===t.type,u);break;case"CIMPictureStroke":G(p,P,o,E,l,e,"CIMPolygonSymbol"===t.type,u);break;case"CIMGradientStroke":It(p,P,o,E,l,e,"CIMPolygonSymbol"===t.type,u);break;case"CIMCharacterMarker":if(kt(p,P,o,E,l,e))break;break;case"CIMPictureMarker":if(kt(p,P,o,E,l,e))break;"CIMLineSymbol"===t.type&&(f=X(p)),_t(p,P,o,E,l,a,e,f,u);break;case"CIMVectorMarker":if(kt(p,P,o,E,l,e))break;"CIMLineSymbol"===t.type&&(f=X(p)),vt(p,P,o,E,l,e,a,f,u,s);break;default:O.error("Cannot analyze CIM layer",p.type)}}}function et(t,i,o,l,e,a){const s=t.primitiveName,n=(0,c.NO)(t.color),[r,f]=dt(l,s,i,null,null),u=(0,L.hP)(JSON.stringify(t)+f).toString();a.push({type:"fill",templateHash:u,materialHash:r?()=>u:u,cim:t,materialOverrides:null,colorLocked:t.colorLocked,color:h(s,o,"Color",e,n,gt),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:i,applyRandomOffset:!1,sampleAlphaOnly:!0})}function pt(t,i,o,l,e,a,s){const n=t.primitiveName,r=t.tintColor?(0,c.NO)(t.tintColor):{r:255,g:255,b:255,a:1},[f,u]=dt(l,n,i,null,null),g=(0,L.hP)(JSON.stringify(t)+u).toString(),p=(0,L.hP)(`${t.url}${JSON.stringify(t.colorSubstitutions)}`).toString();let y=(0,c.NA)(t.scaleX);if("width"in t){const b=t.width;let S=1;const P=a.getResource(t.url);(0,V.pC)(P)&&(S=P.width/P.height),y/=S*(t.height/b)}s.push({type:"fill",templateHash:g,materialHash:f?()=>p:p,cim:t,materialOverrides:null,colorLocked:t.colorLocked,effects:i,color:h(n,o,"TintColor",e,r,gt),height:h(n,o,"Height",e,t.height),scaleX:h(n,o,"ScaleX",e,y),angle:h(n,o,"Rotation",e,(0,c.NA)(t.rotation)),offsetX:h(n,o,"OffsetX",e,(0,c.NA)(t.offsetX)),offsetY:h(n,o,"OffsetY",e,(0,c.NA)(t.offsetY)),url:t.url,applyRandomOffset:!1,sampleAlphaOnly:!1})}function yt(t,i,o,l,e,a){var b;const s=["Rotation","OffsetX","OffsetY"],n=l.filter(S=>S.primitiveName!==t.primitiveName&&!s.includes(S.propertyName)),r=t.primitiveName,[f,u]=dt(l,r,i,null,null),g=(0,L.hP)(JSON.stringify(t)+u).toString(),p=(0,L.hP)(`${t.separation}${JSON.stringify(t.lineSymbol)}`).toString();let y={r:255,g:255,b:255,a:1};if(t.lineSymbol){const S=null==(b=t.lineSymbol)?void 0:b.symbolLayers.find(P=>"CIMSolidStroke"===P.type);S&&(y=(0,c.NO)(S.color))}a.push({type:"fill",templateHash:g,materialHash:f?wt(p,o,n,e):p,cim:t,materialOverrides:n,colorLocked:t.colorLocked,effects:i,color:y,height:h(r,o,"Separation",e,t.separation),scaleX:1,angle:h(r,o,"Rotation",e,(0,c.NA)(t.rotation)),offsetX:h(r,o,"OffsetX",e,(0,c.NA)(t.offsetX)),offsetY:h(r,o,"OffsetY",e,(0,c.NA)(t.offsetY)),applyRandomOffset:!1,sampleAlphaOnly:!0})}function Y(t,i,o,l,e,a){const s=t.primitiveName,[n,r]=dt(l,s,i,null,null),f=(0,L.hP)(JSON.stringify(t)+r).toString();a.push({type:"fill",templateHash:f,materialHash:n?wt(f,o,l,e):f,cim:t,materialOverrides:null,colorLocked:t.colorLocked,effects:i,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,applyRandomOffset:!1,sampleAlphaOnly:!1})}function K(t,i,o,l,e,a,s,n){const r=t.primitiveName,f=(0,c.NO)(t.color),u=void 0!==t.width?t.width:4,g=I(t.capStyle),p=C(t.joinStyle),y=t.miterLimit,[b,S]=dt(l,r,i,null,null),P=(0,L.hP)(JSON.stringify(t)+S).toString();let E,F;if(i&&i instanceof Array&&i.length>0){const w=i[i.length-1];if("CIMGeometricEffectDashes"===w.type&&"NoConstraint"===w.lineDashEnding&&null===w.offsetAlongLine){const R=(i=[...i]).pop();E=R.dashTemplate,F=R.scaleDash}}a.push({type:"line",templateHash:P,materialHash:b?()=>P:P,cim:t,materialOverrides:null,isOutline:s,colorLocked:t.colorLocked,effects:i,color:h(r,o,"Color",e,f,gt),width:h(r,o,"Width",e,u),cap:h(r,o,"CapStyle",e,g),join:h(r,o,"JoinStyle",e,p),miterLimit:h(r,o,"MiterLimit",e,y),referenceWidth:n,zOrder:Bt(t.name),dashTemplate:E,scaleDash:F,sampleAlphaOnly:!0})}function G(t,i,o,l,e,a,s,n){const r=(0,L.hP)(`${t.url}${JSON.stringify(t.colorSubstitutions)}`).toString(),f=t.primitiveName,u=(0,c.NO)(t.tintColor),g=void 0!==t.width?t.width:4,p=I(t.capStyle),y=C(t.joinStyle),b=t.miterLimit,[S,P]=dt(l,f,i,null,null),E=(0,L.hP)(JSON.stringify(t)+P).toString();a.push({type:"line",templateHash:E,materialHash:S?()=>r:r,cim:t,materialOverrides:null,isOutline:s,colorLocked:t.colorLocked,effects:i,color:h(f,o,"TintColor",e,u,gt),width:h(f,o,"Width",e,g),cap:h(f,o,"CapStyle",e,p),join:h(f,o,"JoinStyle",e,y),miterLimit:h(f,o,"MiterLimit",e,b),referenceWidth:n,zOrder:Bt(t.name),dashTemplate:null,scaleDash:!1,url:t.url,sampleAlphaOnly:!1})}function It(t,i,o,l,e,a,s,n){const r=t.primitiveName,f=void 0!==t.width?t.width:4,u=I(t.capStyle),g=C(t.joinStyle),p=t.miterLimit,[y,b]=dt(l,r,i,null,null),S=(0,L.hP)(JSON.stringify(t)+b).toString();a.push({type:"line",templateHash:S,materialHash:y?wt(S,o,l,e):S,cim:t,materialOverrides:null,isOutline:s,colorLocked:t.colorLocked,effects:i,color:{r:128,g:128,b:128,a:1},width:h(r,o,"Width",e,f),cap:h(r,o,"CapStyle",e,u),join:h(r,o,"JoinStyle",e,g),miterLimit:h(r,o,"MiterLimit",e,p),referenceWidth:n,zOrder:Bt(t.name),dashTemplate:null,scaleDash:!1,sampleAlphaOnly:!1})}function kt(t,i,o,l,e,a){const s=t.markerPlacement;if(!s||"CIMMarkerPlacementInsidePolygon"!==s.type)return!1;const n=s,r=Math.abs(n.stepX),f=Math.abs(n.stepY);if(0===r||0===f)return!0;const u=["Rotation","OffsetX","OffsetY"],g=l.filter(R=>R.primitiveName!==t.primitiveName&&!u.includes(R.propertyName)),p="url"in t?t.url:null,[y,b]=dt(l,n.primitiveName,i,null,null),S=(0,L.hP)(JSON.stringify(t)+b).toString();let P,E,F=null;if("Random"===s.gridType){const R=(0,ot.Wz)(m.C1),Q=Math.max(Math.floor(R/r),1),ft=Math.max(Math.floor(R/f),1);P=f*ft,F=mt=>mt?mt*ft:0,E=Q*r/P}else s.shiftOddRows?(P=2*f,F=R=>R?2*R:0,E=r/f*.5):(P=f,F=null,E=r/f);let w={r:255,g:255,b:255,a:1};return"tintColor"in t&&(w=(0,c.NO)(t.tintColor)),a.push({type:"fill",templateHash:S,materialHash:y?wt(S,o,g,e):S,cim:t,materialOverrides:g,colorLocked:t.colorLocked,effects:i,color:h(n.primitiveName,o,"TintColor",e,w,gt),height:h(n.primitiveName,o,"StepY",e,P,F),scaleX:E,angle:h(n.primitiveName,o,"GridAngle",e,n.gridAngle),offsetX:h(n.primitiveName,o,"OffsetX",e,(0,c.NA)(n.offsetX)),offsetY:h(n.primitiveName,o,"OffsetY",e,(0,c.NA)(n.offsetY)),url:p,applyRandomOffset:"Random"===s.gridType,sampleAlphaOnly:!p}),!0}function _t(t,i,o,l,e,a,s,n,r){var ut;const f=t.primitiveName,u=(0,c.NA)(t.size);let g=(0,c.NA)(t.scaleX);const p=(0,c.NA)(t.rotation),y=(0,c.NA)(t.offsetX),b=(0,c.NA)(t.offsetY),S=t.tintColor?(0,c.NO)(t.tintColor):{r:255,g:255,b:255,a:1},P=(0,L.hP)(`${t.url}${JSON.stringify(t.colorSubstitutions)}${JSON.stringify(t.animatedSymbolProperties)}`).toString(),E=jt(t.markerPlacement,l,o,e),F=function Gt(t,i,o,l){const e=[];if(d.E0.findApplicableOverrides(t,i,e),0===e.length)return t;for(const a of e)if(a.valueExpressionInfo){const s=o[a.primitiveName]&&o[a.primitiveName][a.propertyName];s instanceof N.mz&&(a.fn=(n,r,f)=>(0,tt.Z)(s,n,{$view:f},l.geometryType,r))}return(a,s,n)=>{for(const u of e)u.fn&&(u.value=u.fn(a,s,n));const r=(0,Z.d9)(t),f=t.primitiveName;for(const u of e)if(u.primitiveName===f){const g=$t(u.propertyName);null!=u.value&&u.value!==r[g]&&(r[g]=u.value)}return r}}(t.animatedSymbolProperties,l,o,e),[w,R]=dt(l,f,i,E,F),Q=(0,L.hP)(JSON.stringify(t)+R).toString(),ft=null!=(ut=t.anchorPoint)?ut:{x:0,y:0};if("width"in t){const W=t.width;let it=1;const nt=a.getResource(t.url);(0,V.pC)(nt)&&(it=nt.width/nt.height),g/=it*(u/W)}function mt(W,it){return(0,c.hf)(F,W,it)}s.push({type:"marker",templateHash:Q,materialHash:t.animatedSymbolProperties&&!0===t.animatedSymbolProperties.randomizeStartTime?(W,it,nt,St)=>{const Mt=(0,M.$)(St),Ct=mt(W,it);return P+`-MATERIALGROUP(${Mt})-ASP(${JSON.stringify(Ct)})`}:w?(W,it)=>{const nt=mt(W,it);return P+`-ASP(${JSON.stringify(nt)})`}:P,cim:t,materialOverrides:null,colorLocked:t.colorLocked,effects:i,scaleSymbolsProportionally:!1,alignment:n,size:h(f,o,"Size",e,u),scaleX:h(f,o,"ScaleX",e,g),rotation:h(f,o,"Rotation",e,p),offsetX:h(f,o,"OffsetX",e,y),offsetY:h(f,o,"OffsetY",e,b),color:h(f,o,"TintColor",e,S,gt),anchorPoint:{x:ft.x,y:-ft.y},isAbsoluteAnchorPoint:"Relative"!==t.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:t.rotateClockwise,referenceSize:r,sizeRatio:1,markerPlacement:E,url:t.url,animatedSymbolProperties:F})}function vt(t,i,o,l,e,a,s,n,r,f){const u=t.markerGraphics;if(!u)return;let g=0;if(t.scaleSymbolsProportionally){const y=t.frame;y&&(g=y.ymax-y.ymin)}const p=jt(t.markerPlacement,l,o,e);for(const y of u)if(y){const b=y.symbol;if(!b)continue;switch(b.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":Nt(t,i,p,null,y,l,o,e,a,s,n,r,g,f);break;case"CIMTextSymbol":Ot(t,i,p,y,o,l,e,a,n,r,g)}}}function Ot(t,i,o,l,e,a,s,n,r,f,u){d.E0.findApplicableOverrides(l,a,[]);const p=l.geometry;if(!("x"in p)||!("y"in p))return;const y=l.symbol,b=function B(t){return t.underline?"underline":t.strikethrough?"line-through":"none"}(y),S=function j(t){let i="",o="";if(t){const l=t.toLowerCase();l.includes("italic")?i="italic":l.includes("oblique")&&(i="oblique"),l.includes("bold")?o="bold":l.includes("light")&&(o="lighter")}return{style:i,weight:o}}(y.fontStyleName),P=(0,v.BN)(y.fontFamilyName);y.font=Rt({family:P,decoration:b},S);const E=t.frame,F=p.x-.5*(E.xmin+E.xmax),w=p.y-.5*(E.ymin+E.ymax),R=t.size/u,Q=t.primitiveName,ft=(0,c.NA)(y.height)*R,mt=(0,c.NA)(y.angle),ht=(0,c.NA)(t.offsetX)+((0,c.NA)(y.offsetX)+F)*R,ut=(0,c.NA)(t.offsetY)+((0,c.NA)(y.offsetY)+w)*R,W=(0,c.NO)(d.B$.getFillColor(y));let it=(0,c.NO)(d.B$.getStrokeColor(y)),nt=d.B$.getStrokeWidth(y);nt||(it=(0,c.NO)(d.B$.getFillColor(y.haloSymbol)),nt=y.haloSize*R);const[St,Mt]=dt(a,Q,i,o,null),Ct=JSON.stringify(t.effects)+Number(t.colorLocked)+JSON.stringify(t.anchorPoint)+t.anchorPointUnits+JSON.stringify(t.markerPlacement),bt=(0,L.hP)(JSON.stringify(l)+Ct+Mt).toString();let q=h(l.primitiveName,e,"TextString",s,l.textString,c.X3,y.textCase);if(null==q)return;const{fontStyleName:xt}=y,Et=P+(xt?"-"+xt.toLowerCase():"-regular"),At=Et;"string"==typeof q&&q.includes("[")&&y.fieldMap&&(q=(0,c.Qs)(y.fieldMap,q,y.textCase)),n.push({type:"text",templateHash:bt,materialHash:St||"function"==typeof q||q.match(/\[(.*?)\]/)?(st,Xt,Wt)=>At+"-"+(0,c.hf)(q,st,Xt,Wt):At+"-"+(0,L.hP)(q),cim:y,materialOverrides:null,colorLocked:t.colorLocked,effects:i,alignment:r,anchorPoint:{x:t.anchorPoint?t.anchorPoint.x:0,y:t.anchorPoint?t.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==t.anchorPointUnits,fontName:Et,decoration:b,weight:h(Q,e,"Weight",s,S.weight),style:h(Q,e,"Size",s,S.style),size:h(Q,e,"Size",s,ft),angle:h(Q,e,"Rotation",s,mt),offsetX:h(Q,e,"OffsetX",s,ht),offsetY:h(Q,e,"OffsetY",s,ut),horizontalAlignment:A(y.horizontalAlignment),verticalAlignment:T(y.verticalAlignment),text:q,color:W,outlineColor:it,outlineSize:nt,referenceSize:f,sizeRatio:1,markerPlacement:o})}function Nt(t,i,o,l,e,a,s,n,r,f,u,g,p,y){var F;const b=e.symbol,S=b.symbolLayers;if(!S)return;if(y)return void Dt(t,i,o,l,e,s,a,n,r,f,u,g,p);let P=S.length;if(Vt(S))return void function Pt(t,i,o,l,e,a,s,n,r,f,u,g,p){const y=e.geometry,b=a[0],S=a[1],P=(0,z.bk)(y);if(!P)return;const[E,F,w]=(0,z.UV)(P,t.frame,t.size,t.anchorPoint,"Relative"!==t.anchorPointUnits),R={type:"sdf",geom:y,asFill:!0},Q=t.primitiveName,ft=(0,c.NA)(t.size),mt=(0,c.NA)(t.rotation),ht=(0,c.NA)(t.offsetX),ut=(0,c.NA)(t.offsetY),W=S.path,it=S.primitiveName,nt=b.primitiveName,St=(0,c.NO)(d.B$.getFillColor(S)),Mt=(0,c.NO)(d.B$.getStrokeColor(b)),Ct=d.B$.getStrokeWidth(b);let bt=!1,q="";for(const st of s)st.primitiveName!==it&&st.primitiveName!==nt&&st.primitiveName!==Q||(void 0!==st.value?q+=`-${st.primitiveName}-${st.propertyName}-${JSON.stringify(st.value)}`:st.valueExpressionInfo&&(bt=!0));const xt=JSON.stringify(Ut(Rt({},t),{markerGraphics:null})),Et=(0,L.hP)(JSON.stringify(R)+W).toString(),At={type:"marker",templateHash:(0,L.hP)(JSON.stringify(e)+JSON.stringify(S)+JSON.stringify(b)+xt+q).toString(),materialHash:bt?()=>Et:Et,cim:R,materialOverrides:null,colorLocked:t.colorLocked,effects:i,scaleSymbolsProportionally:t.scaleSymbolsProportionally,alignment:u,anchorPoint:{x:F,y:w},isAbsoluteAnchorPoint:!1,size:h(t.primitiveName,n,"Size",r,ft),rotation:h(t.primitiveName,n,"Rotation",r,mt),offsetX:h(t.primitiveName,n,"OffsetX",r,ht),offsetY:h(t.primitiveName,n,"OffsetY",r,ut),scaleX:1,frameHeight:p,rotateClockwise:t.rotateClockwise,referenceSize:g,sizeRatio:E,color:h(it,n,"Color",r,St,gt),outlineColor:h(nt,n,"Color",r,Mt,gt),outlineWidth:h(nt,n,"Width",r,Ct),markerPlacement:o,path:W,animatedSymbolProperties:l};f.push(At)}(t,i,o,l,e,S,a,s,n,r,u,g,p);const E=x.j.applyEffects(b.effects,e.geometry,f.geometryEngine);if(E)for(;P--;){const w=S[P];if(w&&!1!==w.enable)switch(w.type){case"CIMSolidFill":case"CIMSolidStroke":{const R=x.j.applyEffects(w.effects,E,f.geometryEngine),Q=(0,z.bk)(R);if(!Q)continue;const[ft,mt,ht]=(0,z.UV)(Q,t.frame,t.size,t.anchorPoint,"Relative"!==t.anchorPointUnits),ut="CIMSolidFill"===w.type,W={type:"sdf",geom:R,asFill:ut},it=t.primitiveName,nt=null!=(F=(0,c.NA)(t.size))?F:10,St=(0,c.NA)(t.rotation),Mt=(0,c.NA)(t.offsetX),Ct=(0,c.NA)(t.offsetY),bt=w.path,q=w.primitiveName,xt=(0,c.NO)(ut?d.B$.getFillColor(w):d.B$.getStrokeColor(w)),Et=ut?{r:0,g:0,b:0,a:0}:(0,c.NO)(d.B$.getStrokeColor(w)),At=d.B$.getStrokeWidth(w);if(!ut&&!At)break;let st=!1,Xt="";for(const Lt of a)Lt.primitiveName!==q&&Lt.primitiveName!==it||(void 0!==Lt.value?Xt+=`-${Lt.primitiveName}-${Lt.propertyName}-${JSON.stringify(Lt.value)}`:Lt.valueExpressionInfo&&(st=!0));(0,V.pC)(i)&&"function"==typeof i&&(st=!0);const Wt=JSON.stringify(Ut(Rt({},t),{markerGraphics:null})),Jt=(0,L.hP)(JSON.stringify(W)+bt).toString(),qt={type:"marker",templateHash:(0,L.hP)(JSON.stringify(e)+JSON.stringify(w)+Wt+Xt).toString(),materialHash:st?()=>Jt:Jt,cim:W,materialOverrides:null,colorLocked:t.colorLocked,effects:i,scaleSymbolsProportionally:t.scaleSymbolsProportionally,alignment:u,anchorPoint:{x:mt,y:ht},isAbsoluteAnchorPoint:!1,size:h(t.primitiveName,s,"Size",n,nt),rotation:h(t.primitiveName,s,"Rotation",n,St),offsetX:h(t.primitiveName,s,"OffsetX",n,Mt),offsetY:h(t.primitiveName,s,"OffsetY",n,Ct),scaleX:1,frameHeight:p,rotateClockwise:t.rotateClockwise,referenceSize:g,sizeRatio:ft,color:h(q,s,"Color",n,xt,gt),outlineColor:h(q,s,"Color",n,Et,gt),outlineWidth:h(q,s,"Width",n,At),markerPlacement:o,animatedSymbolProperties:l,path:bt};r.push(qt);break}default:Dt(t,i,o,l,e,s,a,n,r,f,u,g,p)}}}function Dt(t,i,o,l,e,a,s,n,r,f,u,g,p){const y=function zt(t,i){return{type:t.type,enable:!0,name:t.name,colorLocked:t.colorLocked,primitiveName:t.primitiveName,anchorPoint:t.anchorPoint,anchorPointUnits:t.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:t.rotateClockwise,rotation:0,size:t.size,billboardMode3D:t.billboardMode3D,depth3D:t.depth3D,frame:t.frame,markerGraphics:[i],scaleSymbolsProportionally:t.scaleSymbolsProportionally,respectFrame:t.respectFrame,clippingPath:t.clippingPath}}(t,e);let b=[];const S=["Rotation","OffsetX","OffsetY"];b=s.filter(W=>W.primitiveName!==t.primitiveName||!S.includes(W.propertyName));let P="";for(const W of s)void 0!==W.value&&(P+=`-${W.primitiveName}-${W.propertyName}-${JSON.stringify(W.value)}`);const[E,F,w]=d.B$.getTextureAnchor(y,f),R=t.primitiveName,Q=(0,c.NA)(t.rotation),ft=(0,c.NA)(t.offsetX),mt=(0,c.NA)(t.offsetY),ht=(0,L.hP)(JSON.stringify(y)+P).toString(),ut={type:"marker",templateHash:ht,materialHash:b.length>0||(0,V.pC)(i)&&"function"==typeof i?wt(ht,a,b,n):ht,cim:y,materialOverrides:b,colorLocked:t.colorLocked,effects:i,scaleSymbolsProportionally:t.scaleSymbolsProportionally,alignment:u,anchorPoint:{x:E,y:F},isAbsoluteAnchorPoint:!1,size:t.size,rotation:h(R,a,"Rotation",n,Q),offsetX:h(R,a,"OffsetX",n,ft),offsetY:h(R,a,"OffsetY",n,mt),color:{r:255,g:255,b:255,a:1},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:p,rotateClockwise:t.rotateClockwise,referenceSize:g,sizeRatio:w/(0,ot.F2)(t.size),markerPlacement:o,animatedSymbolProperties:l};r.push(ut)}function Bt(t){if(t&&0===t.indexOf("Level_")){const i=parseInt(t.substr(6),10);if(!isNaN(i))return i}return 0}function gt(t){if(!t||0===t.length)return null;const i=new at.Z(t).toRgba();return{r:i[0],g:i[1],b:i[2],a:i[3]}}function h(t,i,o,l,e,a,s){const n=i[t];if(n){const r=n[o];if("string"==typeof r||"number"==typeof r||r instanceof Array)return a?a.call(null,r,s):r;if(null!=r&&r instanceof N.mz)return(f,u,g)=>{let p=(0,tt.Z)(r,f,{$view:g},l.geometryType,u);return null!==p&&a&&(p=a.call(null,p,s)),null!==p?p:e}}return e}function $t(t){return t&&t.charAt(0).toLowerCase()+t.substr(1)}function Kt(t,i,o,l){for(const e of i)if(e.valueExpressionInfo){const a=o[e.primitiveName]&&o[e.primitiveName][e.propertyName];a instanceof N.mz&&(e.fn=(s,n,r)=>(0,tt.Z)(a,s,{$view:r},l.geometryType,n))}return(e,a,s)=>{for(const r of i)r.fn&&(r.value=r.fn(e,a,s));const n=[];for(let r of t){const f=null==r?void 0:r.primitiveName;if(f){let u=!1;for(const g of i)if(g.primitiveName===f){const p=$t(g.propertyName);null!=g.value&&g.value!==r[p]&&(u||(r=(0,Z.d9)(r),u=!0),r[p]=g.value)}}n.push(r)}return n}}function jt(t,i,o,l){const e=[];if(d.E0.findApplicableOverrides(t,i,e),0===e.length)return t;for(const a of e)if(a.valueExpressionInfo){const s=o[a.primitiveName]&&o[a.primitiveName][a.propertyName];s instanceof N.mz&&(a.fn=(n,r,f)=>(0,tt.Z)(s,n,{$view:f},l.geometryType,r))}return(a,s,n)=>{for(const u of e)u.fn&&(u.value=u.fn(a,s,n));const r=(0,Z.d9)(t),f=t.primitiveName;for(const u of e)if(u.primitiveName===f){const g=$t(u.propertyName);null!=u.value&&u.value!==r[g]&&(r[g]=u.value)}return r}}function wt(t,i,o,l){for(const e of o)if(e.valueExpressionInfo){const a=i[e.primitiveName]&&i[e.primitiveName][e.propertyName];a instanceof N.mz&&(e.fn=(s,n,r)=>(0,tt.Z)(a,s,{$view:r},l.geometryType,n))}return(e,a,s)=>{for(const n of o)n.fn&&(n.value=n.fn(e,a,s));return(0,L.hP)(t+d.E0.buildOverrideKey(o)).toString()}}function Zt(t,i){if(!i||0===i.length)return t;const o=JSON.parse(JSON.stringify(t));return d.E0.applyOverrides(o,i),o}function dt(t,i,o,l,e){let a=!1,s="";for(const n of t)n.primitiveName===i&&(void 0!==n.value?s+=`-${n.primitiveName}-${n.propertyName}-${JSON.stringify(n.value)}`:n.valueExpressionInfo&&(a=!0));return(0,V.pC)(o)&&"function"==typeof o&&(a=!0),(0,V.pC)(l)&&"function"==typeof l&&(a=!0),(0,V.pC)(e)&&"function"==typeof e&&(a=!0),[a,s]}function Ht(t,i,o){if(t&&i)switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const l=t.symbolLayers;if(!l)return;for(const e of l)switch(Qt(e,i,o),e.type){case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMCharacterMarker":case"CIMPictureMarker":"url"in e&&e.url&&o.push(i.fetchResource(e.url,null));break;case"CIMVectorMarker":{const a=e.markerGraphics;if(!a)continue;for(const s of a)if(s){const n=s.symbol;n&&Ht(n,i,o)}}}}}}const Vt=t=>t&&2===t.length&&t[0].enable&&t[1].enable&&"CIMSolidStroke"===t[0].type&&"CIMSolidFill"===t[1].type&&!t[0].effects&&!t[1].effects;let Tt;function Qt(t,i,o){if(t.effects&&!(0,V.pC)(i.geometryEngine)){if(Tt)return void o.push(Tt);(0,c.Cc)(t.effects)&&(Tt=(0,c.RI)(),o.push(Tt),Tt.then(l=>i.geometryEngine=l))}}},73608:(rt,U,_)=>{_.d(U,{j:()=>ot});var lt=_(91179),at=_(72283),Z=_(29214),ct=_(11004);class ot{static executeEffects(N,d,k){const z=(0,at.GP)(d);let x=new Z.M(z);for(const tt of N){const m=(0,ct.h)(tt);m&&(x=m.execute(x,tt,1.3333333333333333,k))}return x}static next(N){const d=N.next();return(0,at.wp)(d),d}static applyEffects(N,d,k){if(!N)return d;let z=new Z.M(d);for(const tt of N){const m=(0,ct.h)(tt);m&&(z=m.execute(z,tt,1,k))}let c,x=null;for(;c=z.next();)x?(0,lt.l9)(x)?(0,lt.l9)(c)&&x.paths.push(...c.paths):(0,lt.oU)(x)&&(0,lt.oU)(c)&&x.rings.push(...c.rings):x=c;return x}}},39236:(rt,U,_)=>{_.d(U,{Z:()=>ct});var lt=_(26584),at=_(63290),Z=_(7848);function ct(N,d,k,z,c){const x=N.referencesGeometry()&&c?function ot(N,d,k){const{transform:z,hasZ:c,hasM:x}=k;V.has(d)||V.set(d,function L(N){const d={};switch(N){case"esriGeometryPoint":return(k,z,c,x)=>(0,Z.U1)(z,d,k,c,x);case"esriGeometryPolygon":return(k,z,c,x)=>(0,Z.Ie)(z,d,k,c,x);case"esriGeometryPolyline":return(k,z,c,x)=>(0,Z.G6)(z,d,k,c,x);case"esriGeometryMultipoint":return(k,z,c,x)=>(0,Z.J9)(z,d,k,c,x);default:return at.Z.getLogger("esri.views.2d.support.arcadeOnDemand").error(new lt.Z("mapview-arcade",`Unable to handle geometryType: ${N}`)),k=>k}}(d));const tt=V.get(d)(N.geometry,z,c,x);return Ut(Rt({},N),{geometry:tt})}(d,z,c):d,tt=N.repurposeFeature(x);try{return N.evaluate(Ut(Rt({},k),{$feature:tt}))}catch(m){return at.Z.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",m),null}}const V=new Map},21411:(rt,U,_)=>{function Z(N){const d=N.toLowerCase().split(" ").join("-");switch(d){case"serif":return"noto-serif";case"sans-serif":return"arial-unicode-ms";case"monospace":return"ubuntu-mono";case"fantasy":return"cabin-sketch";case"cursive":return"redressed";default:return d}}function ct(N){const d=function ot(N){if(!N.weight)return"";switch(N.weight.toLowerCase()){case"bold":case"bolder":return"-bold"}return""}(N)+function L(N){if(!N.style)return"";switch(N.style.toLowerCase()){case"italic":case"oblique":return"-italic"}return""}(N);return Z(N.family)+(d.length>0?d:"-regular")}_.d(U,{BN:()=>Z,Yc:()=>ct})},3959:(rt,U,_)=>{_.d(U,{$:()=>Z,f:()=>at});var lt=_(77275);function at(ot,L){let N;if("string"==typeof ot)N=(0,lt.hP)(ot+`-seed(${L})`);else{let d=12;N=ot^L;do{N=107*(N>>8^N)+d|0}while(0!=--d)}return(1+N/(1<<31))/2}function Z(ot){return Math.floor(at(ot,ct)*V)}const ct=53290320,V=10}}]);
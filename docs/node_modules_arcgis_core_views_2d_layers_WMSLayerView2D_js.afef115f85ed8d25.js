"use strict";var J=Object.defineProperty,C=Object.getOwnPropertySymbols,K=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable,L=(n,r,e)=>r in n?J(n,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[r]=e,F=(n,r)=>{for(var e in r||(r={}))K.call(r,e)&&L(n,e,r[e]);if(C)for(var e of C(r))X.call(r,e)&&L(n,e,r[e]);return n};(self.webpackChunkdemo2=self.webpackChunkdemo2||[]).push([["node_modules_arcgis_core_views_2d_layers_WMSLayerView2D_js"],{6053:(n,r,e)=>{e.r(r),e.d(r,{default:()=>O});var U=e(15861),h=e(17626),Z=e(63290),R=e(10699),W=e(32917),p=e(77712),I=(e(85931),e(8314),e(90912),e(76898)),j=e(2004),D=e(91757),z=e(37384),G=e(67802),H=e(45611),N=e(94421),v=e(26584),Q=e(13812),T=e(51920);const A=s=>{let t=class extends s{initialize(){this.exportImageParameters=new T.j({layer:this.layer})}destroy(){this.exportImageParameters.destroy(),this.exportImageParameters=null}get exportImageVersion(){var a;return null==(a=this.exportImageParameters)||a.commitProperty("version"),this.commitProperty("timeExtent"),(this._get("exportImageVersion")||0)+1}fetchPopupFeatures(a){const{layer:i}=this;if(!a)return Promise.reject(new v.Z("wmslayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:i}));const{popupEnabled:d}=i;if(!d)return Promise.reject(new v.Z("wmslayerview:fetchPopupFeatures","popupEnabled should be true",{popupEnabled:d}));const y=this.createFetchPopupFeaturesQuery(a);if(!y)return Promise.resolve([]);const{extent:o,width:m,height:l,x:g,y:x}=y;if(!(o&&m&&l))throw new v.Z("wmslayerview:fetchPopupFeatures","WMSLayer does not support fetching features.",{extent:o,width:m,height:l});const c=i.fetchFeatureInfo(o,m,l,g,x);return Promise.resolve(c?[c]:[])}};return(0,h._)([(0,p.Cb)()],t.prototype,"exportImageParameters",void 0),(0,h._)([(0,p.Cb)({readOnly:!0})],t.prototype,"exportImageVersion",null),(0,h._)([(0,p.Cb)()],t.prototype,"layer",void 0),(0,h._)([(0,p.Cb)(Q.qG)],t.prototype,"timeExtent",void 0),t=(0,h._)([(0,I.j)("esri.layers.mixins.WMSLayerView")],t),t},B=Z.Z.getLogger("esri.views.2d.layers.WMSLayerView2D");let u=class extends(A((0,N.Z)((0,z.y)(H.Z)))){constructor(){super(...arguments),this.container=new D.c}supportsSpatialReference(s){return this.layer.serviceSupportsSpatialReference(s)}update(s){this.strategy.update(s).catch(t=>{(0,R.D_)(t)||B.error(t)})}attach(){const{layer:s,container:t}=this,{imageMaxHeight:a,imageMaxWidth:i}=s;this.strategy=new G.Z({container:t,fetchSource:this.fetchImage.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxHeight:a,imageMaxWidth:i,imageRotationSupported:!1,imageNormalizationSupported:!1,hidpi:!1}),this.handles.add((0,W.YP)(()=>this.exportImageVersion,()=>this.requestUpdate()),"exportImageVersion")}detach(){this.handles.remove("exportImageVersion"),this.strategy.destroy(),this.strategy=null,this.container.removeAllChildren()}moveStart(){}viewChange(){}moveEnd(){this.requestUpdate()}createFetchPopupFeaturesQuery(s){const{view:t,container:a}=this,{x:i,y:d}=s,{spatialReference:y}=t;let o=null,m=0,l=0;if(a.children.some(Y=>{const{width:w,height:S,resolution:V,x:f,y:P}=Y,E=f+V*w,M=P-V*S;return i>=f&&i<=E&&d<=P&&d>=M&&(o=new j.Z({xmin:f,ymin:M,xmax:E,ymax:P,spatialReference:y}),m=w,l=S,!0)}),!o)return null;const g=o.width/m,x=Math.round((i-o.xmin)/g),c=Math.round((o.ymax-d)/g);return{extent:o,width:m,height:l,x,y:c}}doRefresh(){var s=this;return(0,U.Z)(function*(){s.requestUpdate()})()}isUpdating(){return this.strategy.updating||this.updateRequested}fetchImage(s,t,a,i){return this.layer.fetchImage(s,t,a,F({timeExtent:this.timeExtent},i))}};(0,h._)([(0,p.Cb)()],u.prototype,"strategy",void 0),(0,h._)([(0,p.Cb)()],u.prototype,"updating",void 0),u=(0,h._)([(0,I.j)("esri.views.2d.layers.WMSLayerView2D")],u);const O=u}}]);